# Car Battery Monitor

Particle [Photon](https://docs.particle.io/datasheets/photon-datasheet/) based WiFi 12v car battery monitor. The idea is to monitor the battery voltage in order to get early warning that the battery is becoming discharged. The project is intended to be directly connected to the battery via its main terminals.

I used [IFTTT](https://ifttt.com/) to send notifications to my phone for low battery events generated by the program.

The program uses the deep sleep mode of the Photon between voltage measurements, in this state the current draw from the battery is ~1mA. It takes about 15 seconds to wake-up, connect to WiFi, take a measurement and send an event containing the measured voltage.

OTA firmware update is support by a the node.js [ota-update.js](ota-update.js), which when the Photon wakes, sends an event to prevent it going back to sleep. Updated firmware can then be flashed using Particle Dev or Particle Build.

## Circuit

![circuit diagram](circuit/battery-monitor.png?raw=true "Title")

## BOM

* Particle Photon
* Traco Power [TSR-1-2450](docs/tsr1.pdf) DC/DC Step-Down Converter
* 1N4747 Zener Diode
* 1000uF 35V Electrolytic Capacitor
* 0.1uF 50V Ceramic Capacitor
* 150uH RF Choke, 4.2ohm, 175mA max
* 1K Resistor
* 220K Resistor
* 22K Resistor

## References

I used the following to design the components which provide protection from noise in the car electrical system caused by the alternator and hopefully more severe events like jump starting.

* [Power Filter/Regulator Circuit](http://linuxcar.sone.jp/reg.en.html)
* [Powering Arduino and switches from 12V automotive battery](http://www.eevblog.com/forum/projects/powering-arduino-and-switches-from-12v-automotive-battery/msg687838/#msg687838)
